!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("prejudice",[],t):"object"==typeof exports?exports.prejudice=t():e.prejudice=t()}("undefined"!=typeof self?self:this,function(){return function(e){function t(n){if(r[n])return r[n].exports;var i=r[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var r={};return t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=6)}([function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=r(3),o=function(e){return e&&e.__esModule?e:{default:e}}(s),a=function(){function e(t){n(this,e),this.baseUrl=t&&t.baseUrl||"",this.observers=[],this.apply=this.apply.bind(this),this.registerBaseUrl=this.registerBaseUrl.bind(this),this.getUrl=this.getUrl.bind(this),this.addObserver=this.addObserver.bind(this)}return i(e,[{key:"getUrl",value:function(){return[this.baseUrl,this.path].join("/")}},{key:"apply",value:function(e,t){return this.observers.forEach(function(t){"function"==typeof t&&t(e)},this),(0,o.default)({url:this.getUrl(),data:JSON.stringify(e),type:"json",method:"post",contentType:"application/json",withCredentials:!0,error:t,success:t}),this}},{key:"registerBaseUrl",value:function(e){return this.baseUrl=e,this}},{key:"addObserver",value:function(e){this.observers.push(e)}}]),e}();t.default=a,e.exports=t.default},function(e,t){var r;r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=function(){function e(){n(this,e),this.records={},this.observers=[],this.addObserver=this.addObserver.bind(this),this.notifyObservers=this.notifyObservers.bind(this),this.add=this.add.bind(this),this.remove=this.remove.bind(this),this.clear=this.clear.bind(this),this.list=this.list.bind(this),this.count=this.count.bind(this),this.findIndex=this.findIndex.bind(this),this.getInstance=this.getInstance.bind(this)}return i(e,[{key:"getInstance",value:function(){return new this.constructor}},{key:"notifyObservers",value:function(){return this.observers.forEach(function(e){"function"==typeof e&&e(this.records)},this),this}},{key:"addObserver",value:function(e){return this.observers.push(e),this}},{key:"add",value:function(e){return-1===this.findIndex(e)&&(this.records[e.datastore]=this.records[e.datastore]||[],this.records[e.datastore].push(e),this.notifyObservers(),!0)}},{key:"findIndex",value:function(e){return this.records[e.datastore]?this.records[e.datastore].findIndex(function(t){return t.datastore===e.datastore&&t.uid===e.uid}):-1}},{key:"remove",value:function(e){var t=this.findIndex(e);return t>=0&&(this.records[e.datastore].splice(t,1),this.notifyObservers(),!0)}},{key:"clear",value:function(e){return e&&this.count(e)>0?(this.records[e]=[],this.notifyObservers(),!0):this.count()>0&&(this.records={},this.notifyObservers(),!0)}},{key:"list",value:function(e){if(e)return this.records[e]||[];var t=[];return Object.keys(this.records).forEach(function(e){t=t.concat(this.list(e))},this),t}},{key:"count",value:function(e){if(e)return this.list(e).length;var t=0;return Object.keys(this.records).forEach(function(e){t+=this.count(e)},this),t}}]),e}();t.default=new s,t.VariableStorageDriver=s},function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_RESULT__;/*!
  * Reqwest! A general purpose XHR connection manager
  * license MIT (c) Dustin Diaz 2015
  * https://github.com/ded/reqwest
  */
!function(e,t,r){void 0!==module&&module.exports?module.exports=r():(__WEBPACK_AMD_DEFINE_FACTORY__=r,void 0!==(__WEBPACK_AMD_DEFINE_RESULT__="function"==typeof __WEBPACK_AMD_DEFINE_FACTORY__?__WEBPACK_AMD_DEFINE_FACTORY__.call(exports,__webpack_require__,exports,module):__WEBPACK_AMD_DEFINE_FACTORY__)&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))}(0,0,function(){function succeed(e){var t=protocolRe.exec(e.url);return t=t&&t[1]||context.location.protocol,httpsRe.test(t)?twoHundo.test(e.request.status):!!e.request.response}function handleReadyState(e,t,r){return function(){return e._aborted?r(e.request):e._timedOut?r(e.request,"Request is aborted: timeout"):void(e.request&&4==e.request[readyState]&&(e.request.onreadystatechange=noop,succeed(e)?t(e.request):r(e.request)))}}function setHeaders(e,t){var r,n=t.headers||{};n.Accept=n.Accept||defaultHeaders.accept[t.type]||defaultHeaders.accept["*"];var i="undefined"!=typeof FormData&&t.data instanceof FormData;t.crossOrigin||n[requestedWith]||(n[requestedWith]=defaultHeaders.requestedWith),n[contentType]||i||(n[contentType]=t.contentType||defaultHeaders.contentType);for(r in n)n.hasOwnProperty(r)&&"setRequestHeader"in e&&e.setRequestHeader(r,n[r])}function setCredentials(e,t){void 0!==t.withCredentials&&void 0!==e.withCredentials&&(e.withCredentials=!!t.withCredentials)}function generalCallback(e){lastValue=e}function urlappend(e,t){return e+(/\?/.test(e)?"&":"?")+t}function handleJsonp(e,t,r,n){var i=uniqid++,s=e.jsonpCallback||"callback",o=e.jsonpCallbackName||reqwest.getcallbackPrefix(i),a=new RegExp("((^|\\?|&)"+s+")=([^&]+)"),u=n.match(a),c=doc.createElement("script"),l=0,f=-1!==navigator.userAgent.indexOf("MSIE 10.0");return u?"?"===u[3]?n=n.replace(a,"$1="+o):o=u[3]:n=urlappend(n,s+"="+o),context[o]=generalCallback,c.type="text/javascript",c.src=n,c.async=!0,void 0===c.onreadystatechange||f||(c.htmlFor=c.id="_reqwest_"+i),c.onload=c.onreadystatechange=function(){if(c[readyState]&&"complete"!==c[readyState]&&"loaded"!==c[readyState]||l)return!1;c.onload=c.onreadystatechange=null,c.onclick&&c.onclick(),t(lastValue),lastValue=void 0,head.removeChild(c),l=1},head.appendChild(c),{abort:function(){c.onload=c.onreadystatechange=null,r({},"Request is aborted: timeout",{}),lastValue=void 0,head.removeChild(c),l=1}}}function getRequest(e,t){var r,n=this.o,i=(n.method||"GET").toUpperCase(),s="string"==typeof n?n:n.url,o=!1!==n.processData&&n.data&&"string"!=typeof n.data?reqwest.toQueryString(n.data):n.data||null,a=!1;return"jsonp"!=n.type&&"GET"!=i||!o||(s=urlappend(s,o),o=null),"jsonp"==n.type?handleJsonp(n,e,t,s):(r=n.xhr&&n.xhr(n)||xhr(n),r.open(i,s,!1!==n.async),setHeaders(r,n),setCredentials(r,n),context[xDomainRequest]&&r instanceof context[xDomainRequest]?(r.onload=e,r.onerror=t,r.onprogress=function(){},a=!0):r.onreadystatechange=handleReadyState(this,e,t),n.before&&n.before(r),a?setTimeout(function(){r.send(o)},200):r.send(o),r)}function Reqwest(e,t){this.o=e,this.fn=t,init.apply(this,arguments)}function setType(e){if(null!==e)return e.match("json")?"json":e.match("javascript")?"js":e.match("text")?"html":e.match("xml")?"xml":void 0}function init(o,fn){function complete(e){for(o.timeout&&clearTimeout(self.timeout),self.timeout=null;self._completeHandlers.length>0;)self._completeHandlers.shift()(e)}function success(resp){var type=o.type||resp&&setType(resp.getResponseHeader("Content-Type"));resp="jsonp"!==type?self.request:resp;var filteredResponse=globalSetupOptions.dataFilter(resp.responseText,type),r=filteredResponse;try{resp.responseText=r}catch(e){}if(r)switch(type){case"json":try{resp=context.JSON?context.JSON.parse(r):eval("("+r+")")}catch(e){return error(resp,"Could not parse JSON in response",e)}break;case"js":resp=eval(r);break;case"html":resp=r;break;case"xml":resp=resp.responseXML&&resp.responseXML.parseError&&resp.responseXML.parseError.errorCode&&resp.responseXML.parseError.reason?null:resp.responseXML}for(self._responseArgs.resp=resp,self._fulfilled=!0,fn(resp),self._successHandler(resp);self._fulfillmentHandlers.length>0;)resp=self._fulfillmentHandlers.shift()(resp);complete(resp)}function timedOut(){self._timedOut=!0,self.request.abort()}function error(e,t,r){for(e=self.request,self._responseArgs.resp=e,self._responseArgs.msg=t,self._responseArgs.t=r,self._erred=!0;self._errorHandlers.length>0;)self._errorHandlers.shift()(e,t,r);complete(e)}this.url="string"==typeof o?o:o.url,this.timeout=null,this._fulfilled=!1,this._successHandler=function(){},this._fulfillmentHandlers=[],this._errorHandlers=[],this._completeHandlers=[],this._erred=!1,this._responseArgs={};var self=this;fn=fn||function(){},o.timeout&&(this.timeout=setTimeout(function(){timedOut()},o.timeout)),o.success&&(this._successHandler=function(){o.success.apply(o,arguments)}),o.error&&this._errorHandlers.push(function(){o.error.apply(o,arguments)}),o.complete&&this._completeHandlers.push(function(){o.complete.apply(o,arguments)}),this.request=getRequest.call(this,success,error)}function reqwest(e,t){return new Reqwest(e,t)}function normalize(e){return e?e.replace(/\r?\n/g,"\r\n"):""}function serial(e,t){var r,n,i,s,o=e.name,a=e.tagName.toLowerCase(),u=function(e){e&&!e.disabled&&t(o,normalize(e.attributes.value&&e.attributes.value.specified?e.value:e.text))};if(!e.disabled&&o)switch(a){case"input":/reset|button|image|file/i.test(e.type)||(r=/checkbox/i.test(e.type),n=/radio/i.test(e.type),i=e.value,(!(r||n)||e.checked)&&t(o,normalize(r&&""===i?"on":i)));break;case"textarea":t(o,normalize(e.value));break;case"select":if("select-one"===e.type.toLowerCase())u(e.selectedIndex>=0?e.options[e.selectedIndex]:null);else for(s=0;e.length&&s<e.length;s++)e.options[s].selected&&u(e.options[s])}}function eachFormElement(){var e,t,r=this;for(t=0;t<arguments.length;t++)e=arguments[t],/input|select|textarea/i.test(e.tagName)&&serial(e,r),function(e,t){var n,i,s;for(n=0;n<t.length;n++)for(s=e[byTag](t[n]),i=0;i<s.length;i++)serial(s[i],r)}(e,["input","select","textarea"])}function serializeQueryString(){return reqwest.toQueryString(reqwest.serializeArray.apply(null,arguments))}function serializeHash(){var e={};return eachFormElement.apply(function(t,r){t in e?(e[t]&&!isArray(e[t])&&(e[t]=[e[t]]),e[t].push(r)):e[t]=r},arguments),e}function buildParams(e,t,r,n){var i,s,o,a=/\[\]$/;if(isArray(t))for(s=0;t&&s<t.length;s++)o=t[s],r||a.test(e)?n(e,o):buildParams(e+"["+("object"==typeof o?s:"")+"]",o,r,n);else if(t&&"[object Object]"===t.toString())for(i in t)buildParams(e+"["+i+"]",t[i],r,n);else n(e,t)}var context=this;if("window"in context)var doc=document,byTag="getElementsByTagName",head=doc[byTag]("head")[0];else{var XHR2;try{XHR2=__webpack_require__(9)}catch(e){throw new Error("Peer dependency `xhr2` required! Please npm install xhr2")}}var httpsRe=/^http/,protocolRe=/(^\w+):\/\//,twoHundo=/^(20\d|1223)$/,readyState="readyState",contentType="Content-Type",requestedWith="X-Requested-With",uniqid=0,callbackPrefix="reqwest_"+ +new Date,lastValue,xmlHttpRequest="XMLHttpRequest",xDomainRequest="XDomainRequest",noop=function(){},isArray="function"==typeof Array.isArray?Array.isArray:function(e){return e instanceof Array},defaultHeaders={contentType:"application/x-www-form-urlencoded",requestedWith:xmlHttpRequest,accept:{"*":"text/javascript, text/html, application/xml, text/xml, */*",xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript",js:"application/javascript, text/javascript"}},xhr=function(e){if(!0===e.crossOrigin){var t=context[xmlHttpRequest]?new XMLHttpRequest:null;if(t&&"withCredentials"in t)return t;if(context[xDomainRequest])return new XDomainRequest;throw new Error("Browser does not support cross-origin requests")}return context[xmlHttpRequest]?new XMLHttpRequest:XHR2?new XHR2:new ActiveXObject("Microsoft.XMLHTTP")},globalSetupOptions={dataFilter:function(e){return e}};return Reqwest.prototype={abort:function(){this._aborted=!0,this.request.abort()},retry:function(){init.call(this,this.o,this.fn)},then:function(e,t){return e=e||function(){},t=t||function(){},this._fulfilled?this._responseArgs.resp=e(this._responseArgs.resp):this._erred?t(this._responseArgs.resp,this._responseArgs.msg,this._responseArgs.t):(this._fulfillmentHandlers.push(e),this._errorHandlers.push(t)),this},always:function(e){return this._fulfilled||this._erred?e(this._responseArgs.resp):this._completeHandlers.push(e),this},fail:function(e){return this._erred?e(this._responseArgs.resp,this._responseArgs.msg,this._responseArgs.t):this._errorHandlers.push(e),this},catch:function(e){return this.fail(e)}},reqwest.serializeArray=function(){var e=[];return eachFormElement.apply(function(t,r){e.push({name:t,value:r})},arguments),e},reqwest.serialize=function(){if(0===arguments.length)return"";var e,t,r=Array.prototype.slice.call(arguments,0);return e=r.pop(),e&&e.nodeType&&r.push(e)&&(e=null),e&&(e=e.type),t="map"==e?serializeHash:"array"==e?reqwest.serializeArray:serializeQueryString,t.apply(null,r)},reqwest.toQueryString=function(e,t){var r,n,i=t||!1,s=[],o=encodeURIComponent,a=function(e,t){t="function"==typeof t?t():null==t?"":t,s[s.length]=o(e)+"="+o(t)};if(isArray(e))for(n=0;e&&n<e.length;n++)a(e[n].name,e[n].value);else for(r in e)e.hasOwnProperty(r)&&buildParams(r,e[r],i,a);return s.join("&").replace(/%20/g,"+")},reqwest.getcallbackPrefix=function(){return callbackPrefix},reqwest.compat=function(e,t){return e&&(e.type&&(e.method=e.type)&&delete e.type,e.dataType&&(e.type=e.dataType),e.jsonpCallback&&(e.jsonpCallbackName=e.jsonpCallback)&&delete e.jsonpCallback,e.jsonp&&(e.jsonpCallback=e.jsonp)),new Reqwest(e,t)},reqwest.ajaxSetup=function(e){e=e||{};for(var t in e)globalSetupOptions[t]=e[t]},reqwest})},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=function(){function e(){n(this,e),this.engine=null,this.registerEngine=this.registerEngine.bind(this)}return i(e,[{key:"registerEngine",value:function(e){this.engine=e}}]),e}();t.default=s,e.exports=t.default},function(e,t,r){"use strict";(function(n){function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=function e(t,r,n){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,r);if(void 0===i){var s=Object.getPrototypeOf(t);return null===s?void 0:e(s,r,n)}if("value"in i)return i.value;var o=i.get;if(void 0!==o)return o.call(n)},c=r(2),l=function(e){function t(e,r){i(this,t);var o=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return o.key=r,o.storage=e,o.read(),n.window.addEventListener("storage",function(e){return function(t){t.storageArea===e.storage&&(e.read(),e.notifyObservers())}}(o)),o.read=o.read.bind(o),o.write=o.write.bind(o),o}return o(t,e),a(t,[{key:"getInstance",value:function(){return this}},{key:"read",value:function(){try{this.records=JSON.parse(this.storage.getItem(this.key))||{}}catch(e){this.records={}}return this}},{key:"write",value:function(){return this.storage.setItem(this.key,JSON.stringify(this.records)),this}},{key:"add",value:function(e){return!!u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"add",this).call(this,e)&&(this.write(),!0)}},{key:"remove",value:function(e){return!!u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"remove",this).call(this,e)&&(this.write(),!0)}},{key:"clear",value:function(e){return!!u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"clear",this).call(this,e)&&(this.write(),!0)}}]),t}(c.VariableStorageDriver);t.default=l,e.exports=t.default}).call(t,r(1))},function(e,t,r){"use strict";(function(n){function i(e){return e&&e.__esModule?e:{default:e}}function s(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(7),c=i(u),l=r(8),f=i(l),d=r(2),h=i(d),p=r(0),v=i(p),y=r(10),b=i(y),g=r(11),_=i(g),m=r(12),O=i(m),w=r(13),j=i(w),k=r(14),R=i(k),P=r(15),x=i(P),E=r(16),T=i(E),A=r(17),S=i(A),U=r(4),I=i(U),D=r(18),C=i(D),q=r(19),M=i(q),F=r(20),H=i(F),B=r(21),N=i(B),L=r(22),X=i(L),J=r(23),W=i(J),z=r(24),K=i(z),V=function(){function e(t){o(this,e),this.recordStorage=(t.recordStorage||c.default).getInstance(),this.actions={text:b.default,email:_.default,tag:j.default,favorite:R.default,untag:x.default,unfavorite:T.default,file:O.default},this.datastores={},this.profile=X.default.getInstance(),this.favoritesList=W.default.getInstance(),this.favoritesSuggest=K.default.getInstance(),this.addObserver=this.addObserver.bind(this),this.setRecordStorage=this.setRecordStorage.bind(this),this.addRecord=this.addRecord.bind(this),this.listRecords=this.listRecords.bind(this),this.removeRecord=this.removeRecord.bind(this),this.act=this.act.bind(this),this.clearRecords=this.clearRecords.bind(this),this.registerRecordEngine=this.registerRecordEngine.bind(this),this.resolveRecord=this.resolveRecord.bind(this),this.registerDatastore=this.registerDatastore.bind(this),this.registerActionBaseUrl=this.registerActionBaseUrl.bind(this),this.addProfileObserver=this.addProfileObserver.bind(this),this.addFavoritesListObserver=this.addFavoritesListObserver.bind(this),this.addFavoritesSuggestObserver=this.addFavoritesSuggestObserver.bind(this),this.favoriteAdded=this.favoriteAdded.bind(this),this.favoriteRemoved=this.favoriteRemoved(this),this.tagAdded=this.tagAdded.bind(this),this.tagRemoved=this.tagRemoved.bind(this),t.recordEngine&&this.registerRecordEngine(t.recordEngine),t.datastores&&t.datastores.forEach(function(e){e.slug&&e.uid&&(this.datastores[e.uid]=[t.baseUrl||n.window.location.origin,e.slug,"record"].join("/"))},this),t.actionBaseUrl&&this.registerActionBaseUrl(t.actionBaseUrl),this.actions.favorite.addObserver(this.favoriteAdded),this.actions.unfavorite.addObserver(this.favoriteRemoved),this.actions.tag.addObserver(this.tagAdded),this.actions.untag.addObserver(this.tagRemoved)}return a(e,[{key:"favoriteAdded",value:function(e){this.favoritesList.addFavorite(e)}},{key:"favoriteRemoved",value:function(e){this.favoritesList.removeFavorite(e)}},{key:"tagAdded",value:function(e){this.favoritesList.addTag(e),this.favoritesSuggest.add(e)}},{key:"tagRemoved",value:function(e){this.favoritesList.removeTag(e)}},{key:"registerActionBaseUrl",value:function(e){return this.profile.registerBaseUrl(e),this.favoritesList.registerBaseUrl(e),this.favoritesSuggest.registerBaseUrl(e),this.actions.text.registerBaseUrl(e),this.actions.email.registerBaseUrl(e),this.actions.file.registerBaseUrl(e),this.actions.favorite.registerBaseUrl(e),this.actions.unfavorite.registerBaseUrl(e),this.actions.tag.registerBaseUrl(e),this.actions.untag.registerBaseUrl(e),this}},{key:"registerDatastore",value:function(e,t){return this.datastores[e]=t,this}},{key:"registerRecordEngine",value:function(t){return e.Driver.Record.UidHash.registerEngine(t),e.Driver.Record.ReactHash.registerEngine(t),e.Driver.Record.Pride.registerEngine(t),this}},{key:"addProfileObserver",value:function(e){return this.profile.addObserver(e),this}},{key:"addFavoritesListObserver",value:function(e){return this.favoritesList.addObserver(e),this}},{key:"addFavoritesSuggestObserver",value:function(e){return this.favoritesSuggest.addObserver(e),this}},{key:"addObserver",value:function(e){return this.recordStorage.addObserver(e),this}},{key:"setRecordStorage",value:function(e){return this.recordStorage=e,this}},{key:"addRecord",value:function(e){return e.uid&&e.datastore?(this.recordStorage.add(e),this):(e=this.resolveRecord(e),e.renderFull(function(e,t){return function(r){r.has_holdings?e.getHoldings(function(e,t){return function(r){t.rawHoldings=r,e.add(t)}}(t,r)):t.add(r)}}(e,this.recordStorage)),this)}},{key:"resolveRecord",value:function(t){return e.Driver.Record.ReactHash.match(t)?e.Driver.Record.ReactHash.dataToRecord(t):e.Driver.Record.UidHash.match(t)?e.Driver.Record.UidHash.dataToRecord(t):e.Driver.Record.Pride.match(t)?e.Driver.Record.Pride.dataToRecord(t):e.Driver.Record.Null.dataToRecord(t)}},{key:"listRecords",value:function(e){return this.recordStorage.list(e)}},{key:"countRecords",value:function(e){return this.recordStorage.count(e)}},{key:"removeRecord",value:function(e){return e.uid&&e.datastore?(this.recordStorage.remove(e),this):(e=this.resolveRecord(e),e.renderFull(function(e){return function(t){e.remove(t)}}(this.recordStorage)),this)}},{key:"act",value:function(e,t,r,n){return this.actions[e].apply(s({to:r},t,s({records:this.listRecords(t).map(function(e){return e.uid})},"base_url",this.datastores[t])),n),this}},{key:"clearRecords",value:function(e){return this.recordStorage.clear(e),this}}]),e}();Object.defineProperty(V,"SessionStorageDriver",{value:c.default}),Object.defineProperty(V,"LocalStorageDriver",{value:f.default}),Object.defineProperty(V,"VariableStorageDriver",{value:h.default}),Object.defineProperty(V,"Profile",{value:X.default}),Object.defineProperty(V,"FavoritesList",{value:W.default}),Object.defineProperty(V,"FavoritesSuggest",{value:K.default}),Object.defineProperty(V,"Action",{value:v.default}),Object.defineProperty(V.Action,"Text",{value:b.default}),Object.defineProperty(V.Action,"Email",{value:_.default}),Object.defineProperty(V.Action,"File",{value:O.default}),Object.defineProperty(V.Action,"Tag",{value:j.default}),Object.defineProperty(V.Action,"Favorite",{value:R.default}),Object.defineProperty(V.Action,"UnTag",{value:x.default}),Object.defineProperty(V.Action,"UnFavorite",{value:T.default}),Object.defineProperty(V,"Driver",{value:S.default}),Object.defineProperty(V.Driver,"Record",{value:I.default}),Object.defineProperty(V.Driver.Record,"UidHash",{value:C.default}),Object.defineProperty(V.Driver.Record,"ReactHash",{value:M.default}),Object.defineProperty(V.Driver.Record,"Pride",{value:H.default}),Object.defineProperty(V.Driver.Record,"Null",{value:N.default}),t.default=V,e.exports=t.default}).call(t,r(1))},function(e,t,r){"use strict";(function(n){function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var s=r(2),o=i(s),a=r(5),u=i(a),c=o.default;void 0!==n.window&&(c=new u.default(n.window.sessionStorage,"Prejudice.sessionStorage")),t.default=c,e.exports=t.default}).call(t,r(1))},function(e,t,r){"use strict";(function(n){function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var s=r(2),o=i(s),a=r(5),u=i(a),c=o.default;void 0!==n.window&&(c=new u.default(n.window.localStorage,"Prejudice.localStorage")),t.default=c,e.exports=t.default}).call(t,r(1))},function(e,t){},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var o=r(0),a=function(e){return e&&e.__esModule?e:{default:e}}(o),u=function(e){function t(){n(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.path="text",e}return s(t,e),t}(a.default);t.default=new u,e.exports=t.default},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var o=r(0),a=function(e){return e&&e.__esModule?e:{default:e}}(o),u=function(e){function t(){n(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.path="email",e}return s(t,e),t}(a.default);t.default=new u,e.exports=t.default},function(e,t,r){"use strict";(function(n){function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(0),c=function(e){return e&&e.__esModule?e:{default:e}}(u),l=function(e){function t(){i(this,t);var e=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.path="file",e.formId="action-file-download",e.targetName="action-file-download-target",e.ensureForm=e.ensureForm.bind(e),e.submitForm=e.submitForm.bind(e),e.setFormInput=e.setFormInput.bind(e),e.ensureTarget=e.ensureTarget.bind(e),e}return o(t,e),a(t,[{key:"ensureTarget",value:function(){if(n.document.getElementsByName(this.targetName).length>0)return this;var e=n.document.createElement("iframe");return e.src="about:blank",e.name=this.targetName,e.style="visibility: hidden; display: none;",n.document.body.appendChild(e),this}},{key:"ensureForm",value:function(){if(n.document.getElementById(this.formId))return this;var e=n.document.createElement("form"),t=n.document.createElement("input");return e.id=this.formId,e.action=this.getUrl(),e.method="post",e.target=this.targetName,e.enctype="text/plain",t.type="hidden",e.appendChild(t),n.document.body.appendChild(e),this}},{key:"setFormInput",value:function(e){var t=n.document.getElementById(this.formId).children[0];t.name=JSON.stringify(e).slice(0,-1)+',"_":"',t.value='"}'}},{key:"submitForm",value:function(){n.document.getElementById(this.formId).submit()}},{key:"apply",value:function(e,t){this.ensureTarget(),this.ensureForm(),this.setFormInput(e),this.submitForm(),t({status:"Success"})}}]),t}(c.default);t.default=new l,e.exports=t.default}).call(t,r(1))},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var o=r(0),a=function(e){return e&&e.__esModule?e:{default:e}}(o),u=function(e){function t(){n(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.path="tag",e}return s(t,e),t}(a.default);t.default=new u,e.exports=t.default},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var o=r(0),a=function(e){return e&&e.__esModule?e:{default:e}}(o),u=function(e){function t(){n(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.path="favorite",e}return s(t,e),t}(a.default);t.default=new u,e.exports=t.default},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var o=r(0),a=function(e){return e&&e.__esModule?e:{default:e}}(o),u=function(e){function t(){n(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.path="untag",e}return s(t,e),t}(a.default);t.default=new u,e.exports=t.default},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var o=r(0),a=function(e){return e&&e.__esModule?e:{default:e}}(o),u=function(e){function t(){n(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.path="unfavorite",e}return s(t,e),t}(a.default);t.default=new u,e.exports=t.default},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(){n(this,e)};t.default=i,e.exports=t.default},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(4),u=function(e){return e&&e.__esModule?e:{default:e}}(a),c=function(e){function t(){n(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.dataToRecord=e.dataToRecord.bind(e),e.match=e.match.bind(e),e}return s(t,e),o(t,[{key:"match",value:function(e){return e.datastoreUid&&e.recordUid}},{key:"dataToRecord",value:function(e){return this.engine.requestRecord(e.datastoreUid,e.recordUid)}}]),t}(u.default);t.default=new c,e.exports=t.default},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(4),u=function(e){return e&&e.__esModule?e:{default:e}}(a),c=function(e){function t(){n(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.dataToRecord=e.dataToRecord.bind(e),e.match=e.match.bind(e),e}return s(t,e),o(t,[{key:"match",value:function(e){return e.datastore&&e.uid}},{key:"dataToRecord",value:function(e){return this.engine.requestRecord(e.datastore,e.uid)}}]),t}(u.default);t.default=new c,e.exports=t.default},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(4),u=function(e){return e&&e.__esModule?e:{default:e}}(a),c=function(e){function t(){n(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.dataToRecord=e.dataToRecord.bind(e),e.match=e.match.bind(e),e}return s(t,e),o(t,[{key:"match",value:function(e){return e instanceof this.engine.Core.Record}},{key:"dataToRecord",value:function(e){return e}}]),t}(u.default);t.default=new c,e.exports=t.default},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=function(){function e(){n(this,e)}return i(e,[{key:"match",value:function(e){return!1}},{key:"dataToRecord",value:function(){return this}}]),e}();t.default=new s,e.exports=t.default},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=r(3),o=function(e){return e&&e.__esModule?e:{default:e}}(s),a=function(){function e(){n(this,e),this.last={},this.baseUrl=null,this.observers=[],this.interval=null,this.intervalDuration=3e5,this.registerBaseUrl=this.registerBaseUrl.bind(this),this.addObserver=this.addObserver.bind(this),this.notifyObservers=this.notifyObservers.bind(this),this.update=this.update.bind(this),this.handleData=this.handleData.bind(this),this.getUrl=this.getUrl.bind(this),this.setInterval=this.setInterval.bind(this),this.getInstance=this.getInstance.bind(this)}return i(e,[{key:"getInstance",value:function(){return this}},{key:"setInterval",value:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){return this.interval?this:(this.interval=setInterval(function(e){return function(){e.update()}}(this),this.intervalDuration),this)})},{key:"notifyObservers",value:function(){this.observers.forEach(function(e){"function"==typeof e&&e(this.last)},this)}},{key:"update",value:function(){if(this.baseUrl&&this.observers.length>0){var e=function(e){return function(t){e.handleData(t)}}(this);(0,o.default)({url:this.getUrl(),type:"json",method:"get",contentType:"application/json",withCredentials:!0,error:e,success:e})}return this}},{key:"handleData",value:function(e){return JSON.stringify(this.last)!==JSON.stringify(e)&&(this.last=e,this.notifyObservers()),this}},{key:"getUrl",value:function(){return this.baseUrl?[this.baseUrl,"profile"].join("/"):null}},{key:"addObserver",value:function(e){return e(this.last),this.observers.push(e),this.startup(),this}},{key:"startup",value:function(){return!this.interval&&this.baseUrl&&this.observers.length>0&&(this.last={},this.update(),this.setInterval()),this}},{key:"registerBaseUrl",value:function(e){return this.baseUrl=e,this.startup(),this}}]),e}();t.default=new a,e.exports=t.default},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=r(3),o=function(e){return e&&e.__esModule?e:{default:e}}(s),a=function(){function e(){n(this,e),this.last=[],this.baseUrl=null,this.observers=[],this.interval=null,this.intervalDuration=3e5,this.registerBaseUrl=this.registerBaseUrl.bind(this),this.addObserver=this.addObserver.bind(this),this.notifyObservers=this.notifyObservers.bind(this),this.update=this.update.bind(this),this.handleData=this.handleData.bind(this),this.getUrl=this.getUrl.bind(this),this.setInterval=this.setInterval.bind(this),this.getInstance=this.getInstance.bind(this),this.addFavorite=this.addFavorite.bind(this),this.removeFavorite=this.removeFavorite.bind(this),this.addTag=this.addTag.bind(this),this.removeTag=this.removeTag.bind(this)}return i(e,[{key:"getInstance",value:function(){return this}},{key:"setInterval",value:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){return this.interval?this:(this.interval=setInterval(function(e){return function(){e.update()}}(this),this.intervalDuration),this)})},{key:"notifyObservers",value:function(){this.observers.forEach(function(e){"function"==typeof e&&e(this.last)},this)}},{key:"update",value:function(){if(this.baseUrl){var e=function(e){return function(t){e.handleData(t)}}(this);(0,o.default)({url:this.getUrl(),type:"json",method:"get",contentType:"application/json",withCredentials:!0,error:e,success:e})}return this}},{key:"handleData",value:function(e){return JSON.stringify(this.last)!==JSON.stringify(e)&&(this.last=e,this.notifyObservers()),this}},{key:"getUrl",value:function(){return this.baseUrl?[this.baseUrl,"profile","favorites","list"].join("/"):null}},{key:"addObserver",value:function(e){return e(this.last),this.observers.push(e),this.startup(),this}},{key:"startup",value:function(){return!this.interval&&this.baseUrl&&(this.last=[],this.update(),this.setInterval()),this}},{key:"registerBaseUrl",value:function(e){return this.baseUrl=e,this.startup(),this}},{key:"favoritedItem",value:function(e,t,r){var n={};return"mirlyn"===e?(n.id=["http://mirlyn.lib.umich.edu/Record/"+t],n.tags=["mirlyn-favorite"],n.type="mirlyn"):"articles"===e?(n.id=["http://www.lib.umich.edu/articles/details/"+t],n.tags=["articles-favorite"],n.type="article"):"databases"===e?(n.id=["http://www.lib.umich.edu/node/"+t],n.tags=["databases-favorite"],n.type="database"):"journals"===e?(n.id=["http://mirlyn.lib.umich.edu/Record/"+t],n.tags=["journals-favorite"],n.type="journal"):"website"===e&&(n.id=[t],n.tags=["website-favorite"],n.type="website"),n}},{key:"addFavorite",value:function(e){var t=!1;return Object.keys(e).forEach(function(r){e[r]&&Array.isArray(e[r].records)&&(e[r].records||[]).forEach(function(e){var n=this.favoritedItem(r,e);this.last.find(function(e){return e.id[0]===n.id[0]})||(t=!0,this.last.push(n))},this)},this),t&&this.notifyObservers(),this}},{key:"removeFavorite",value:function(e){var t=!1;return Object.keys(e).forEach(function(r){e[r]&&Array.isArray(e[r].records)&&(e[r].records||[]).forEach(function(e){var n=this.favoritedItem(r,e),i=this.last.findIndex(function(e){return e.id[0]===n.id[0]});i>=0&&(t=!0,this.last=this.last.slice(0,i).concat(this.last.slice(i+1,this.last.length)))},this)},this),t&&this.notifyObservers(),this}},{key:"addTag",value:function(e){var t=Array.isArray(e.to)?e.to:[e.to],r=!1;return Object.keys(e).forEach(function(n){e[n]&&Array.isArray(e[n].records)&&(e[n].records||[]).forEach(function(e){var i=this.favoritedItem(n,e),s=this.last.find(function(e){return e.id[0]===i.id[0]});s?(r=!0,s.tags=(s.tags||[]).concat(t)):(r=!0,i.tags=t,this.last.push(i))},this)},this),r&&this.notifyObservers(),this}},{key:"removeTag",value:function(e){var t=Array.isArray(e.to)?e.to:[e.to],r=!1;return Object.keys(e).forEach(function(n){e[n]&&Array.isArray(e[n].records)&&(e[n].records||[]).forEach(function(e){var i=this.favoritedItem(n,e),s=this.last.find(function(e){return e.id[0]===i.id[0]});s&&t.forEach(function(e){var t=s.tags.findIndex(function(t){return t===e});t>=0&&(r=!0,s.tags=s.tags.slice(0,t).concat(s.tags.slice(t+1,s.tags.length)))})},this)},this),r&&this.notifyObservers(),this}}]),e}();t.default=new a,e.exports=t.default},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=r(3),o=function(e){return e&&e.__esModule?e:{default:e}}(s),a=function(){function e(){n(this,e),this.last={},this.baseUrl=null,this.observers=[],this.interval=null,this.intervalDuration=3e5,this.registerBaseUrl=this.registerBaseUrl.bind(this),this.addObserver=this.addObserver.bind(this),this.notifyObservers=this.notifyObservers.bind(this),this.update=this.update.bind(this),this.handleData=this.handleData.bind(this),this.getUrl=this.getUrl.bind(this),this.setInterval=this.setInterval.bind(this),this.getInstance=this.getInstance.bind(this),this.add=this.add.bind(this)}return i(e,[{key:"getInstance",value:function(){return this}},{key:"setInterval",value:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){return this.interval?this:(this.interval=setInterval(function(e){return function(){e.update()}}(this),this.intervalDuration),this)})},{key:"notifyObservers",value:function(){this.observers.forEach(function(e){"function"==typeof e&&e(this.last)},this)}},{key:"update",value:function(){if(this.baseUrl){var e=function(e){return function(t){e.handleData(t)}}(this);(0,o.default)({url:this.getUrl(),type:"json",method:"get",contentType:"application/json",withCredentials:!0,error:e,success:e})}return this}},{key:"handleData",value:function(e){return JSON.stringify(this.last)!==JSON.stringify(e)&&(this.last=e,this.notifyObservers()),this}},{key:"getUrl",value:function(){return this.baseUrl?[this.baseUrl,"profile","favorites","suggest"].join("/"):null}},{key:"addObserver",value:function(e){return e(this.last),this.observers.push(e),this.startup(),this}},{key:"startup",value:function(){return!this.interval&&this.baseUrl&&(this.last={},this.update(),this.setInterval()),this}},{key:"registerBaseUrl",value:function(e){return this.baseUrl=e,this.startup(),this}},{key:"add",value:function(e){var t=Array.isArray(e.to)?e.to:[e.to],r=!1;return this.last.courses&&this.last.recent?(t.forEach(function(e){return this.last.recent.find(function(t){return t===e})?this:this.last.courses.find(function(t){return t===e})?this:(r=!0,this.last.recent.push(e),this)},this),r&&this.notifyObservers(),this):this}}]),e}();t.default=new a,e.exports=t.default}])});